<%= form_with(id: "post_form", model: [@trip, @post]) do |form| %>
  <div class="form">
    <% if @post.errors.any? %>
      <div class="error-message">
        <%= @post.errors.full_messages.to_sentence.capitalize %>
      </div>
    <% end %>

    <div class="form__field">
      <% if @trip %>
        <%= form.hidden_field :trip_id, value: @trip.id %>
      <% else %>
        <%= form.hidden_field :trip_id, value: @post.trip.id %>
      <% end %>
    </div>

    <div class="form__field">
      <div class="form__header">
        <%= form.text_field :title,
          class: "form__input form__input--dark form__input--short form__input--h4",
          placeholder: "Add a title",
          input_html: { autofocus: true } %>

        <% if @post.persisted? %>
          <% if post.created_at === post.updated_at %>
            <p>
              <%=
                link_to post.user.username,
                url_for(
                  controller: '/users',
                  action: 'show',
                  username: post.user.username
                ),
                class: "text__link",
                data: { turbo_frame: "_top" }
              %>
              created this post on <%= post.updated_at&.strftime("%B %d, %Y") %>
            </p>
          <% else %>
            <p>
              <%=
                link_to post.user.username,
                url_for(
                  controller: '/users',
                  action: 'show',
                  username: post.user.username
                ),
                class: "text__link",
                data: { turbo_frame: "_top" }
              %>
              edited this post on <%= post.updated_at&.strftime("%B %d, %Y") %></p>
          <% end %>
        <% end %>
      </div>
    </div>

    <div class="form__field">
      <%= form.text_area :body,
        placeholder: "Add a description",
        class: "form__input form__input--dark form__input--body",
        size: "30x3", required: true %>
    </div>

    <div class="form__actions">
      <%= form.submit class: "btn btn--green" %>
      <%= link_to "Cancel", trip_url(@trip),
          class: "btn btn--light" %>
    </div>
  </div>
<% end %>